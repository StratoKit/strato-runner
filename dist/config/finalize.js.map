{"version":3,"sources":["../../src/config/finalize.js"],"names":["path","require","processConfig","finalize","config","options","context","deployment","process","env","NODE_ENV","instance","NODE_APP_INSTANCE","ifFalsy","params","ifTruthy","resolve","join","map","missing","length","console","error"],"mappings":";;;;;AAAA;;AAEA,MAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,MAAMC,gBAAgBD,QAAQ,iBAAR,CAAtB;;AAEA,MAAME,WAAWC,UAAU;AAC1B,OAAMC,UAAU;AACf;AACAC,WAAS;AACRC,eAAYC,QAAQC,GAAR,CAAYC,QAAZ,IAAwB,aAD5B;AAERC,aAAUH,QAAQC,GAAR,CAAYG,iBAFd;AAGRC,YAAS,CAAC,EAACC,MAAD,EAAD,KAAcA,OAAO,CAAP,KAAaA,OAAO,CAAP,CAH5B;AAIRC,aAAU,CAAC,EAACD,MAAD,EAAD,KAAcA,OAAO,CAAP,KAAaA,OAAO,CAAP,CAJ7B;;AAMR;AACA;AACA;AACA;AACAb,YAAS,CAAC,EAACa,MAAD,EAASE,OAAT,EAAD,KAAuBf,QAAQD,KAAKiB,IAAL,CAAUH,OAAOI,GAAP,CAAWF,OAAX,CAAV,CAAR;AAVxB;AAFM,EAAhB;AAeA,OAAMG,UAAUjB,cAAcE,MAAd,EAAsBC,OAAtB,CAAhB;;AAEA,KAAIc,QAAQC,MAAZ,EAAoB;AACnB;AACAC,UAAQC,KAAR,CAAc,mDAAd,EAAmEH,OAAnE;AACA;AACD,CAtBD;;kBAwBehB,Q","file":"finalize.js","sourcesContent":["// Load the user configuration and post-process\n\nconst path = require('path')\nconst processConfig = require('./processConfig')\n\nconst finalize = config => {\n\tconst options = {\n\t\t// used in template expansion, you can also place functions here\n\t\tcontext: {\n\t\t\tdeployment: process.env.NODE_ENV || 'development',\n\t\t\tinstance: process.env.NODE_APP_INSTANCE,\n\t\t\tifFalsy: ({params}) => params[0] || params[1],\n\t\t\tifTruthy: ({params}) => params[0] && params[1],\n\n\t\t\t// Allow config to call require()\n\t\t\t// This works in the scope of this file, so only use global requires\n\t\t\t// If stratokit is part of a webpack bundle, you first need to grab the global\n\t\t\t// require from the bundle using an external like `{realReq: 'var require'}`\n\t\t\trequire: ({params, resolve}) => require(path.join(params.map(resolve))),\n\t\t},\n\t}\n\tconst missing = processConfig(config, options)\n\n\tif (missing.length) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error('!!! These config templates could not be expanded:', missing)\n\t}\n}\n\nexport default finalize\n"]}