{"version":3,"sources":["../../src/config/finalize.js"],"names":["path","require","processConfig","finalize","config","options","context","deployment","process","env","NODE_ENV","instance","NODE_APP_INSTANCE","ifFalsy","params","ifTruthy","resolve","join","map","missing","length","console","error"],"mappings":";;;;;;;AAAA;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAC,iBAAD,CAA7B;;AAEA,MAAME,QAAQ,GAAGC,MAAM,IAAI;AAC1B,QAAMC,OAAO,GAAG;AACf;AACAC,IAAAA,OAAO,EAAE;AACRC,MAAAA,UAAU,EAAEC,OAAO,CAACC,GAAR,CAAYC,QAAZ,IAAwB,aAD5B;AAERC,MAAAA,QAAQ,EAAEH,OAAO,CAACC,GAAR,CAAYG,iBAFd;AAGRC,MAAAA,OAAO,EAAE,CAAC;AAACC,QAAAA;AAAD,OAAD,KAAcA,MAAM,CAAC,CAAD,CAAN,IAAaA,MAAM,CAAC,CAAD,CAHlC;AAIRC,MAAAA,QAAQ,EAAE,CAAC;AAACD,QAAAA;AAAD,OAAD,KAAcA,MAAM,CAAC,CAAD,CAAN,IAAaA,MAAM,CAAC,CAAD,CAJnC;AAMR;AACA;AACA;AACA;AACAb,MAAAA,OAAO,EAAE,CAAC;AAACa,QAAAA,MAAD;AAASE,QAAAA;AAAT,OAAD,KAAuBf,OAAO,CAACD,IAAI,CAACiB,IAAL,CAAUH,MAAM,CAACI,GAAP,CAAWF,OAAX,CAAV,CAAD;AAV/B;AAFM,GAAhB;AAeA,QAAMG,OAAO,GAAGjB,aAAa,CAACE,MAAD,EAASC,OAAT,CAA7B;;AAEA,MAAIc,OAAO,CAACC,MAAZ,EAAoB;AACnB;AACAC,IAAAA,OAAO,CAACC,KAAR,CAAc,mDAAd,EAAmEH,OAAnE;AACA;AACD,CAtBD;;eAwBehB,Q","sourcesContent":["// Load the user configuration and post-process\n\nconst path = require('path')\nconst processConfig = require('./processConfig')\n\nconst finalize = config => {\n\tconst options = {\n\t\t// used in template expansion, you can also place functions here\n\t\tcontext: {\n\t\t\tdeployment: process.env.NODE_ENV || 'development',\n\t\t\tinstance: process.env.NODE_APP_INSTANCE,\n\t\t\tifFalsy: ({params}) => params[0] || params[1],\n\t\t\tifTruthy: ({params}) => params[0] && params[1],\n\n\t\t\t// Allow config to call require()\n\t\t\t// This works in the scope of this file, so only use global requires\n\t\t\t// If stratokit is part of a webpack bundle, you first need to grab the global\n\t\t\t// require from the bundle using an external like `{realReq: 'var require'}`\n\t\t\trequire: ({params, resolve}) => require(path.join(params.map(resolve))),\n\t\t},\n\t}\n\tconst missing = processConfig(config, options)\n\n\tif (missing.length) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error('!!! These config templates could not be expanded:', missing)\n\t}\n}\n\nexport default finalize\n"],"file":"finalize.js"}